# .travis.xml for use with EPICS Base ci-scripts
# (see: https://github.com/epics-base/ci-scripts)

language: cpp
compiler: gcc
dist: xenial

cache:
  directories:
  - $HOME/.cache

env:
  global:
    - SETUP_PATH=.ci-local:.ci
    - MODULES="asyn calc"
    - ASYN_HOOK=.ci-local/fix_RELEASE.sh
    - CALC_HOOK=.ci-local/fix_RELEASE.sh

addons:
  apt:
    packages:
    - libreadline6-dev
    - libncurses5-dev
    - perl
    - libpcre3-dev

install:
  - .ci/travis/prepare.sh
  - .ci-local/fix_RELEASE.sh

script:
  - .ci/travis/build.sh

matrix:
  include:
  - env: BASE=R3.14.12.8
  - env: BASE=R3.15.6
  - env: BASE=R7.0.3

# Windows
    
  - env: BASE=7.0 WINE=32 TEST=NO STATIC=YES
    compiler: mingw

  - env: BASE=7.0 WINE=64 TEST=NO STATIC=NO
    compiler: mingw

  - env: BASE=7.0 TEST=NO STATIC=NO
    os: windows
    compiler: cl

# RTEMS

  - env: BASE=7.0 RTEMS=4.10 TEST=NO

  - env: BASE=7.0 RTEMS=4.9 TEST=NO

# MacOS
  - env: BASE=7.0
    os: osx
    compiler: clang
